<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Evapotranspiraci√≥n - Samani y Hargreaves - UNALM</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: Arial, sans-serif;
            background-color: #f5f5f5;
        }

        .header {
            background-color: #0C6854;
            color: white;
            padding: 20px;
            text-align: center;
        }

        .header h1 {
            font-size: 20px;
            margin-bottom: 8px;
        }

        .header p {
            font-size: 13px;
            margin: 3px 0;
        }

        .container {
            max-width: 1400px;
            margin: 30px auto;
            padding: 20px;
        }

        .back-btn {
            display: inline-block;
            background-color: #0C6854;
            color: white;
            padding: 8px 20px;
            text-decoration: none;
            border-radius: 5px;
            margin-bottom: 20px;
            font-size: 14px;
        }

        .back-btn:hover {
            background-color: #084a3a;
        }

        .module-card {
            background: white;
            padding: 30px;
            border-radius: 8px;
            border-left: 4px solid #0C6854;
            margin-bottom: 20px;
        }

        .module-card h2 {
            color: #0C6854;
            margin-bottom: 15px;
            font-size: 22px;
        }

        .description {
            background: #f0f9f7;
            padding: 15px;
            border-radius: 5px;
            margin-bottom: 25px;
            line-height: 1.6;
        }

        .input-grid {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(250px, 1fr));
            gap: 20px;
            margin-bottom: 30px;
        }

        .form-group {
            margin-bottom: 20px;
        }

        .form-group label {
            display: block;
            color: #333;
            font-weight: bold;
            margin-bottom: 8px;
            font-size: 15px;
        }

        .form-group input {
            width: 100%;
            padding: 12px;
            border: 2px solid #0C6854;
            border-radius: 5px;
            font-size: 16px;
        }

        .form-group input:focus {
            outline: none;
            border-color: #084a3a;
            box-shadow: 0 0 5px rgba(12, 104, 84, 0.3);
        }

        .form-group small {
            display: block;
            color: #666;
            margin-top: 5px;
            font-size: 13px;
        }

        .section-title {
            color: #0C6854;
            font-size: 18px;
            font-weight: 600;
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 2px solid #0C6854;
        }

        .data-table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
            background: white;
            box-shadow: 0 2px 8px rgba(0, 0, 0, 0.08);
            font-size: 13px;
        }

        .data-table th {
            background-color: #0C6854;
            color: white;
            padding: 10px 6px;
            text-align: center;
            font-size: 13px;
            border: 1px solid #0C6854;
        }

        .data-table td {
            padding: 8px 6px;
            text-align: center;
            border: 1px solid #ddd;
        }

        .data-table input {
            width: 100%;
            padding: 8px;
            border: 1px solid #0C6854;
            border-radius: 3px;
            text-align: center;
            font-size: 14px;
        }

        .data-table input:focus {
            outline: none;
            border-color: #084a3a;
            box-shadow: 0 0 3px rgba(12, 104, 84, 0.3);
        }

        .btn-calculate {
            background-color: #0C6854;
            color: white;
            padding: 15px 40px;
            border: none;
            border-radius: 5px;
            font-size: 16px;
            cursor: pointer;
            width: 100%;
            margin-top: 20px;
            transition: background-color 0.3s;
        }

        .btn-calculate:hover {
            background-color: #084a3a;
        }

        .results {
            background: white;
            padding: 25px;
            border-radius: 8px;
            border-left: 4px solid #0C6854;
            margin-top: 25px;
            display: none;
        }

        .results.show {
            display: block;
            animation: fadeIn 0.5s;
        }

        @keyframes fadeIn {
            from { opacity: 0; transform: translateY(10px); }
            to { opacity: 1; transform: translateY(0); }
        }

        .results h3 {
            color: #0C6854;
            margin-bottom: 20px;
            font-size: 20px;
        }

        .methodology {
            margin-top: 30px;
            padding: 25px;
            background: #f0f9f7;
            border-radius: 8px;
            border-left: 4px solid #0C6854;
        }

        .methodology h3 {
            color: #0C6854;
            margin-bottom: 20px;
            font-size: 18px;
        }

        .methodology p {
            margin-bottom: 12px;
            line-height: 1.8;
        }

        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }

            .module-card {
                padding: 20px;
            }

            .header h1 {
                font-size: 18px;
            }

            .input-grid {
                grid-template-columns: 1fr;
            }

            .data-table {
                font-size: 11px;
            }

            .data-table th,
            .data-table td {
                padding: 5px 3px;
            }
        }
    </style>
</head>
<body>
    <!-- Header -->
    <div class="header">
        <h1>Universidad Nacional Agraria La Molina</h1>
        <p>Maestr√≠a en Recursos H√≠dricos</p>
        <p>Curso: M√©todos de an√°lisis en ingenier√≠a de recursos h√≠dricos</p>
        <p>Docente: Dr. Eduardo Chavarri Velarde</p>
    </div>

    <!-- Contenido -->
    <div class="container">
        <a href="../index.html" class="back-btn">‚Üê Volver al Men√∫</a>

        <div class="module-card">
            <h2>üåæ Evapotranspiraci√≥n - M√©todo de Samani y Hargreaves (1985)</h2>
            
            <div class="description">
                <p>
                    El m√©todo de Samani y Hargreaves (1985) es un m√©todo emp√≠rico para estimar la 
                    evapotranspiraci√≥n de referencia (ETo) utilizando datos de temperatura y radiaci√≥n 
                    solar extraterrestre. Es especialmente √∫til cuando no se dispone de todos los 
                    par√°metros requeridos por m√©todos m√°s complejos como Penman-Monteith.
                </p>
            </div>

            <!-- Formulario -->
            <form id="calculatorForm">
                <!-- Datos generales -->
                <h3 class="section-title">üìç Datos Generales</h3>
                
                <div class="input-grid">
                    <div class="form-group">
                        <label for="anio">A√±o:</label>
                        <input type="number" id="anio" min="1900" max="2100" value="2025" required>
                        <small>A√±o del an√°lisis</small>
                    </div>

                    <div class="form-group">
                        <label for="elevacion">Elevaci√≥n (m.s.n.m.):</label>
                        <input type="number" id="elevacion" step="0.1" value="2620" required>
                        <small>Altitud sobre el nivel del mar</small>
                    </div>

                    <div class="form-group">
                        <label for="latitud">Latitud (grados decimales):</label>
                        <input type="number" id="latitud" step="0.01" min="-90" max="90" value="-7.1" required>
                        <small>Latitud (negativo = Sur, positivo = Norte)</small>
                    </div>

                    <div class="form-group">
                        <label for="longitud">Longitud (grados decimales):</label>
                        <input type="number" id="longitud" step="0.01" min="-180" max="180" value="-78.5" required>
                        <small>Longitud (negativo = Oeste, positivo = Este)</small>
                    </div>
                </div>

                <!-- Datos mensuales -->
                <h3 class="section-title">üìä Datos Clim√°ticos Mensuales</h3>
                
                <div style="overflow-x: auto;">
                    <table class="data-table">
                        <thead>
                            <tr>
                                <th>Mes</th>
                                <th>Precipitaci√≥n Media<br>(mm)</th>
                                <th>Temperatura M√°xima<br>T<sub>max</sub> (¬∞C)</th>
                                <th>Temperatura M√≠nima<br>T<sub>min</sub> (¬∞C)</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr><td><strong>Enero</strong></td><td><input type="number" id="precip_1" step="0.1" value="71" required></td><td><input type="number" id="tmax_1" step="0.1" value="21.6" required></td><td><input type="number" id="tmin_1" step="0.1" value="9" required></td></tr>
                            <tr><td><strong>Febrero</strong></td><td><input type="number" id="precip_2" step="0.1" value="247" required></td><td><input type="number" id="tmax_2" step="0.1" value="18.7" required></td><td><input type="number" id="tmin_2" step="0.1" value="6.5" required></td></tr>
                            <tr><td><strong>Marzo</strong></td><td><input type="number" id="precip_3" step="0.1" value="200" required></td><td><input type="number" id="tmax_3" step="0.1" value="19.4" required></td><td><input type="number" id="tmin_3" step="0.1" value="7.4" required></td></tr>
                            <tr><td><strong>Abril</strong></td><td><input type="number" id="precip_4" step="0.1" value="99" required></td><td><input type="number" id="tmax_4" step="0.1" value="20.5" required></td><td><input type="number" id="tmin_4" step="0.1" value="7.1" required></td></tr>
                            <tr><td><strong>Mayo</strong></td><td><input type="number" id="precip_5" step="0.1" value="55" required></td><td><input type="number" id="tmax_5" step="0.1" value="20.7" required></td><td><input type="number" id="tmin_5" step="0.1" value="5.4" required></td></tr>
                            <tr><td><strong>Junio</strong></td><td><input type="number" id="precip_6" step="0.1" value="6" required></td><td><input type="number" id="tmax_6" step="0.1" value="21.2" required></td><td><input type="number" id="tmin_6" step="0.1" value="4.4" required></td></tr>
                            <tr><td><strong>Julio</strong></td><td><input type="number" id="precip_7" step="0.1" value="5" required></td><td><input type="number" id="tmax_7" step="0.1" value="21.7" required></td><td><input type="number" id="tmin_7" step="0.1" value="2.6" required></td></tr>
                            <tr><td><strong>Agosto</strong></td><td><input type="number" id="precip_8" step="0.1" value="17" required></td><td><input type="number" id="tmax_8" step="0.1" value="21.2" required></td><td><input type="number" id="tmin_8" step="0.1" value="3" required></td></tr>
                            <tr><td><strong>Septiembre</strong></td><td><input type="number" id="precip_9" step="0.1" value="67" required></td><td><input type="number" id="tmax_9" step="0.1" value="21.7" required></td><td><input type="number" id="tmin_9" step="0.1" value="5.1" required></td></tr>
                            <tr><td><strong>Octubre</strong></td><td><input type="number" id="precip_10" step="0.1" value="1" required></td><td><input type="number" id="tmax_10" step="0.1" value="22.6" required></td><td><input type="number" id="tmin_10" step="0.1" value="4.2" required></td></tr>
                            <tr><td><strong>Noviembre</strong></td><td><input type="number" id="precip_11" step="0.1" value="23" required></td><td><input type="number" id="tmax_11" step="0.1" value="22.2" required></td><td><input type="number" id="tmin_11" step="0.1" value="3" required></td></tr>
                            <tr><td><strong>Diciembre</strong></td><td><input type="number" id="precip_12" step="0.1" value="114" required></td><td><input type="number" id="tmax_12" step="0.1" value="21.4" required></td><td><input type="number" id="tmin_12" step="0.1" value="7.1" required></td></tr>
                        </tbody>
                    </table>
                </div>

                <button type="submit" class="btn-calculate">üî¨ Calcular Evapotranspiraci√≥n</button>
            </form>
        </div>

        <!-- Resultados -->
        <div class="results" id="results">
            <h3>üìä Resultados del C√°lculo - M√©todo de Samani y Hargreaves (1985)</h3>
            
            <div style="overflow-x: auto; margin-top: 20px;">
                <table class="data-table" id="resultsTable"></table>
            </div>

            <!-- Metodolog√≠a de c√°lculo -->
            <div class="methodology">
                <h3>üìã Metodolog√≠a de C√°lculo por Filas</h3>
                <div style="line-height: 1.8;">
                    <p><strong>1. D√≠as/periodo (DM):</strong> N√∫mero de d√≠as de cada mes (28-31 d√≠as). Total = Suma de d√≠as del a√±o.</p>
                    
                    <p><strong>2. DEC (radianes):</strong> Declinaci√≥n solar = 0.409 √ó sin(0.0172J - 1.39), donde J es el d√≠a juliano medio del mes.</p>
                    
                    <p><strong>3. ES:</strong> Distancia relativa tierra-sol = 1 + 0.033 √ó sin(0.0172J).</p>
                    
                    <p><strong>4-6. PRECIP MED, TEM MAX, TEM MIN:</strong> Datos de entrada proporcionados. Totales/Promedios seg√∫n corresponda.</p>
                    
                    <p><strong>7. TC (¬∞C):</strong> Temperatura media = (Tmax + Tmin) / 2. Total = Promedio anual.</p>
                    
                    <p><strong>8. TD (¬∞C):</strong> Diferencia t√©rmica = Tmax - Tmin.</p>
                    
                    <p><strong>9. TD^0.5:</strong> Ra√≠z cuadrada de TD = TD<sup>0.5</sup>.</p>
                    
                    <p><strong>10. L (cal/cc):</strong> Calor latente de vaporizaci√≥n = 595.9 - 0.55 √ó TC.</p>
                    
                    <p><strong>11. tan(latitud) √ó tan(DEC):</strong> Producto de tangentes para c√°lculo del √°ngulo horario.</p>
                    
                    <p><strong>12. OM (radianes):</strong> √Ångulo de puesta del sol = arccos[-tan(latitud) √ó tan(DEC)].</p>
                    
                    <p><strong>13. RLD (mm):</strong> Radiaci√≥n solar extraterrestre diaria = 916.732 √ó [OM √ó sen(latitud) √ó sen(DEC) + cos(latitud) √ó cos(DEC) √ó sen(OM)] / ES.</p>
                    
                    <p><strong>14. Ra (mm):</strong> Radiaci√≥n extraterrestre mensual = 10 √ó (DM √ó RLD) / L.</p>
                    
                    <p><strong>15. ETo (mm):</strong> <span style="color: #0C6854; font-weight: bold;">Evapotranspiraci√≥n de referencia = 0.0023 √ó Ra √ó (TC + 17.8) √ó TD<sup>0.5</sup></span>. Total = Suma anual.</p>
                    
                    <p><strong>16. PRECIP CONFIABLE (mm):</strong> Precipitaci√≥n confiable = -10 + 0.75 √ó PRECIP MEDIA. Total = Suma anual.</p>
                    
                    <p><strong>17. DEFICIT (mm):</strong> D√©ficit h√≠drico = PRECIP CONFIABLE - ETo.</p>
                    
                    <p><strong>18. MAI:</strong> √çndice de aridez mensual = PRECIP CONFIABLE / ETo.</p>
                </div>
            </div>
        </div>
    </div>

    <script>
        const form = document.getElementById('calculatorForm');
        const resultsDiv = document.getElementById('results');

        form.addEventListener('submit', function(e) {
            e.preventDefault();
            calcularEvapotranspiracion();
        });

        function calcularEvapotranspiracion() {
            const anio = parseInt(document.getElementById('anio').value);
            const elevacion = parseFloat(document.getElementById('elevacion').value);
            const latitud = parseFloat(document.getElementById('latitud').value);
            const longitud = parseFloat(document.getElementById('longitud').value);

            const precipitacion = [];
            const tmax = [];
            const tmin = [];

            for (let i = 1; i <= 12; i++) {
                precipitacion.push(parseFloat(document.getElementById(`precip_${i}`).value));
                tmax.push(parseFloat(document.getElementById(`tmax_${i}`).value));
                tmin.push(parseFloat(document.getElementById(`tmin_${i}`).value));
            }

            if (isNaN(anio) || isNaN(elevacion) || isNaN(latitud) || isNaN(longitud)) {
                alert('Por favor complete todos los datos generales');
                return;
            }

            const diasMedios = [15, 43, 74, 104, 135, 165, 196, 227, 257, 288, 318, 349];
            const diasMes = [31, 28, 31, 30, 31, 30, 31, 31, 30, 31, 30, 31];
            const esBisiesto = (anio % 4 === 0 && anio % 100 !== 0) || (anio % 400 === 0);
            if (esBisiesto) diasMes[1] = 29;

            const latitudRad = latitud * Math.PI / 180;

            const DM = diasMes;
            const DEC = [], ES = [], TC = [], TD = [], TD05 = [], L = [], tantan = [], OM = [];
            const RLD = [], Ra = [], ETo = [], precipConfiable = [], deficit = [], MAI = [];

            for (let i = 0; i < 12; i++) {
                const J = diasMedios[i];
                ES[i] = 1 + 0.033 * Math.sin(0.0172 * J);
                DEC[i] = 0.409 * Math.sin(0.0172 * J - 1.39);
                TC[i] = (tmax[i] + tmin[i]) / 2;
                TD[i] = tmax[i] - tmin[i];
                TD05[i] = Math.pow(TD[i], 0.5);
                L[i] = 595.9 - 0.55 * TC[i];
                tantan[i] = Math.tan(latitudRad) * Math.tan(DEC[i]);
                OM[i] = Math.acos(-tantan[i]);
                RLD[i] = 916.732 * (OM[i] * Math.sin(latitudRad) * Math.sin(DEC[i]) + 
                         Math.cos(latitudRad) * Math.cos(DEC[i]) * Math.sin(OM[i])) / ES[i];
                Ra[i] = 10 * (DM[i] * RLD[i]) / L[i];
                ETo[i] = 0.0023 * Ra[i] * (TC[i] + 17.8) * TD05[i];
                precipConfiable[i] = -10 + 0.75 * precipitacion[i];
                deficit[i] = precipConfiable[i] - ETo[i];
                MAI[i] = precipConfiable[i] / ETo[i];
            }

            // Calcular totales y promedios
            const totales = {
                DM: DM.reduce((a, b) => a + b, 0),
                precip: precipitacion.reduce((a, b) => a + b, 0),
                tmax: tmax.reduce((a, b) => a + b, 0) / 12,
                tmin: tmin.reduce((a, b) => a + b, 0) / 12,
                TC: TC.reduce((a, b) => a + b, 0) / 12,
                ETo: ETo.reduce((a, b) => a + b, 0),
                precipConf: precipConfiable.reduce((a, b) => a + b, 0)
            };

            llenarTablaResultados(DM, DEC, ES, precipitacion, tmax, tmin, TC, TD, TD05, L, 
                                  tantan, OM, RLD, Ra, ETo, precipConfiable, deficit, MAI, totales);

            resultsDiv.classList.add('show');
            resultsDiv.scrollIntoView({ behavior: 'smooth', block: 'nearest' });
        }

        function llenarTablaResultados(DM, DEC, ES, precip, tmax, tmin, TC, TD, TD05, L, 
                                       tantan, OM, RLD, Ra, ETo, precipConf, deficit, MAI, totales) {
            const meses = ['Ene', 'Feb', 'Mar', 'Abr', 'May', 'Jun', 'Jul', 'Ago', 'Sep', 'Oct', 'Nov', 'Dic'];
            const filas = [
                {label: 'D√≠as/periodo (DM)', data: DM, formato: 0, total: totales.DM},
                {label: 'DEC (radianes)', data: DEC, formato: 4},
                {label: 'ES', data: ES, formato: 4},
                {label: 'PRECIP MED (mm)', data: precip, formato: 1, bg: '#f0f9f7', total: totales.precip},
                {label: 'TEM MAX (¬∞C)', data: tmax, formato: 1, bg: '#f0f9f7', total: totales.tmax},
                {label: 'TEM MIN (¬∞C)', data: tmin, formato: 1, bg: '#f0f9f7', total: totales.tmin},
                {label: 'TC (¬∞C)', data: TC, formato: 2, total: totales.TC},
                {label: 'TD (¬∞C)', data: TD, formato: 2},
                {label: 'TD^0.5', data: TD05, formato: 3},
                {label: 'L (cal/cc)', data: L, formato: 2},
                {label: 'tan(latitud) x tan(DEC)', data: tantan, formato: 4},
                {label: 'OM (radianes)', data: OM, formato: 4},
                {label: 'RLD (mm)', data: RLD, formato: 2},
                {label: 'Ra = 10 x (DM x RLD)/L (mm)', data: Ra, formato: 2},
                {label: 'ETo (mm)', data: ETo, formato: 2, bg: '#fff3cd', total: totales.ETo},
                {label: 'PRECIP CONFIABLE (mm)', data: precipConf, formato: 2, total: totales.precipConf},
                {label: 'DEFICIT (mm)', data: deficit, formato: 2},
                {label: 'MAI', data: MAI, formato: 2}
            ];

            let html = '<thead><tr><th style="min-width: 200px;">Par√°metro</th>';
            meses.forEach(mes => html += `<th>${mes}</th>`);
            html += '<th style="background-color: #084a3a;">TOTAL/PROM</th></tr></thead><tbody>';

            filas.forEach(fila => {
                const bgStyle = fila.bg ? ` style="background-color: ${fila.bg};"` : '';
                html += `<tr${bgStyle}><td><strong>${fila.label}</strong></td>`;
                
                for (let i = 0; i < 12; i++) {
                    html += `<td>${fila.data[i].toFixed(fila.formato)}</td>`;
                }
                
                if (fila.total !== undefined) {
                    html += `<td style="font-weight: bold; background-color: #f0f9f7;">${fila.total.toFixed(fila.formato)}</td>`;
                } else {
                    html += `<td style="background-color: #f0f9f7;">-</td>`;
                }
                
                html += '</tr>';
            });

            html += '</tbody>';
            document.getElementById('resultsTable').innerHTML = html;
        }
    </script>
</body>
</html>